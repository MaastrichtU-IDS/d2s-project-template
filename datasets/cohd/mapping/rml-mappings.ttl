@prefix rr: <http://www.w3.org/ns/r2rml#>
@prefix foaf: <http://xmlns.com/foaf/0.1/>
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>
@prefix rml: <http://semweb.mmlab.be/ns/rml#>
@prefix ql: <http://semweb.mmlab.be/ns/ql#>
PREFIX bl: <https://w3id.org/biolink/vocab/>
@base <https://w3id.org/d2s/>

# dataset_id	concept_id_1	concept_id_2	concept_count	concept_prevalence	chi_square_t	chi_square_p	expected_count	ln_ratio	rel_freq_1	rel_freq_2
# 3	2003351	4043182	39	2.251917e-05	7.670977e+02	7.687639e-169	1.915134e+00	3.013774e+00	1.300000e+00	3.527560e-04
# 3	2003351	4078442	39	2.251917e-05	1.292931e+03	3.884704e-283	1.152185e+00	3.521902e+00	1.300000e+00	5.863427e-04
# 3	2003351	4111798	39	2.251917e-05	1.797332e+03	0.000000e+00	8.336423e-01	3.845513e+00	1.300000e+00	8.103896e-04


<MapAssociation> a rr:TriplesMap;
  rml:logicalSource [ 
    rml:source "/mnt/data/cohd/paired_concept_counts_associations.csv";
    rml:referenceFormulation ql:CSV
  ];
  rr:subjectMap [ 
    rr:template "https://w3id.org/biolink/cohd/association/{dataset_id}_{concept_id_1}_{concept_id_2}";
    rr:class bl:Association
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:relation; 
    rr:objectMap bl:related_to
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:id; 
    rr:objectMap [ rr:template "https://w3id.org/biolink/cohd/association/{dataset_id}_{concept_id_1}_{concept_id_2}" ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:subject; 
    rr:objectMap [ rr:template "http://api.ohdsi.org/WebAPI/vocabulary/concept/{concept_id_1}" ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:object; 
    rr:objectMap [ rr:template "http://api.ohdsi.org/WebAPI/vocabulary/concept/{concept_id_2}" ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:provided_by; 
    rr:objectMap [ rr:template "https://w3id.org/biolink/cohd/provider/dataset/{dataset_id}" ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:has_evidence; 
    rr:objectMap [ rr:template "https://w3id.org/biolink/cohd/association/evidence/{dataset_id}_{concept_id_1}_{concept_id_2}" ]
  ] .

<MapEvidenceType> a rr:TriplesMap;    
  rml:logicalSource [ 
    rml:source "/mnt/data/cohd/paired_concept_counts_associations.csv";
    rml:referenceFormulation ql:CSV
  ];
  rr:subjectMap [ 
    rr:template "https://w3id.org/biolink/cohd/evidence/{dataset_id}_{concept_id_1}_{concept_id_2}";
    rr:class bl:EvidenceType
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:name ;
    rr:objectMap [ rr:template "Count of co-occurences of the 2 concepts {dataset_id} and {concept_id_1} in COHD dataset {concept_id_2}" ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:id; 
    rr:objectMap [ rr:template "https://w3id.org/biolink/cohd/evidence/{dataset_id}_{concept_id_1}_{concept_id_2}" ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:has_count; 
    rr:objectMap [ rml:reference "concept_count"; rr:datatype xsd:double ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:has_total; 
    rr:objectMap [ rml:reference "rel_freq_2"; rr:datatype xsd:double ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:has_quotient; 
    rr:objectMap [ rml:reference "concept_prevalence"; rr:datatype xsd:double ]
  ];
  rr:predicateObjectMap [ 
    rr:predicate bl:provided_by; 
    rr:objectMap [ rr:template "https://w3id.org/biolink/cohd/provider/dataset/{dataset_id}" ]
  ] .